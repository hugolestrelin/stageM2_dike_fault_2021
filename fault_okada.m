function [sig,u1,u2] = fault_okada(x,z,mu,L,d,nu,theta,xsi)
    s=[L*cosd(theta),L*sind(theta)];
    r1=((x-xsi(1)).^2+(z-xsi(2)).^2).^(1/2);
    r2=((x-xsi(1)).^2+(z+xsi(2)).^2).^(1/2);
    t1=atand((x-2*xsi(1))./(z-xsi(2)));
    t2=atand((x-2*xsi(1))./(z+xsi(2)));
    u1=s(1)/(pi*(1-nu))*((1-nu)/2*(t2-t1)+(x-xsi(1)).*(z-xsi(2))./(4*r1.^2)-(x-xsi(1)).*(z+(3-4*nu)*xsi(2))./(4*r2.^2)+xsi(2)*z.*(x-xsi(1)).*(z+xsi(2))./(r2.^4))+s(2)/(pi*(1-nu))*((1-2*nu)/4*log(r2./r1)-((z-xsi(2)).^2)./(4*r1.^2)+(z.^2+xsi(2)^2-4*(1-nu)*xsi(2)*(z+xsi(2)))./(4*r2.^2)+(xsi(2)*z.*(z+xsi(2)).^2)./(r2.^4));
    u2=s(1)/(pi*(1-nu))*((1-2*nu)/4*log(r2./r1)+((z-xsi(2)).^2)./(4*r1.^2)-((z+xsi(2)).^2-2*xsi(2)^2-2*(1-2*nu)*xsi(2)*(z+xsi(2)))./(4*r2.^2)+(xsi(2)*z.*(z+xsi(2)).^2)./(r2.^4))+s(2)/(pi*(1-nu))*((1-nu)/2*(t2-t1)+(x-xsi(1)).*(z-xsi(2))./(4*r1.^2)-(x-xsi(1)).*(z+(3-4*nu)*xsi(2))./(4*r2.^2)-xsi(2)*z.*(x-xsi(1)).*(z+xsi(2))./(r2.^4));
    sig.xx=mu*s(2)/(2*pi*(1-nu))*((x-xsi(1)).*((z-xsi(2)).^2-(x-xsi(1)).^2)./(r1.^4)-(x-xsi(1)).*((z+xsi(2)).^2-(x-xsi(1)).^2)./(r2.^4)+4*xsi(2)*(x-xsi(1))./(r2.^6).*((2*xsi(2)-z).*(z+xsi(2)).^2+(3*z+2*xsi(2)).*(x-xsi(1)).^2))-mu*s(1)/(2*pi*(1-nu))*((z-xsi(2)).*((z-xsi(2)).^2+3*(x-xsi(1)).^2)./(r1.^4)-(z+xsi(2)).*((z+xsi(2)).^2+3*(x-xsi(1)).^2)./(r2.^4)+2*xsi(2)./(r2.^6).*(6*z.*(z+xsi(2)).*(x-xsi(1)).^2-(z-xsi(2)).*(z+xsi(2)).^3-(x-xsi(1)).^4)); 
    sig.yy=-mu*s(2)/(2*pi*(1-nu))*(d*(x-xsi(1)).*(3*(z-xsi(2)).^2-(x-xsi(1)).^2)...
    ./(r1.^4)-(x-xsi(1)).*(3*(z+xsi(2)).^2+(x-xsi(1)).^2)...
    ./(r2.^4)-4*xsi(2)*(x-xsi(1)).*z...
    ./(r2.^6).*(3*(z+xsi(2)).^2-(x-xsi(1))))-mu*s(1)/(2*pi*(1-nu))*((z-xsi(2)).*((z-xsi(2)).^2-(x-xsi(1)).^2)...
    ./(r1.^4)-(z+xsi(2)).*((z+xsi(2)).^2-(x-xsi(1)).^2)...
    ./(r2.^4)-2*xsi(2)./(r2.^6).*(6*z.*(z+xsi(2)).*(x-xsi(1)).^2-(3*z+xsi(2)).*(z+xsi(2)).^3+(x-xsi(1)).^4)); 
    sig.xy=mu*s(2)/(2*pi*(1-nu))*((z-xsi(2)).*((z-xsi(2)).^2-(x-xsi(1)).^2)./(r1.^4)-(z+xsi(2)).*((z+xsi(2)).^2-(x-xsi(1)).^2)./(r2.^4)+...
    2*xsi(2)./(r2.^6).*(6*z.*(z+xsi(2)).*(x-xsi(1)).^2-(x-xsi(1)).^4+(xsi(2)-z).*(z+xsi(2)).^3))-mu*s(1)/(2*pi*(1-nu))*((x-xsi(1)).*((z-xsi(2)).^2-(x-xsi(1)).^2)./(r1.^4)-(x-xsi(1)).*((z+xsi(2)).^2-(x-xsi(1)).^2)./(r2.^4)+4*xsi(2)*z.*(x-xsi(1))./(r2.^6).*(3*(z+xsi(2)).^2-(x-xsi(1)).^2)); 
end